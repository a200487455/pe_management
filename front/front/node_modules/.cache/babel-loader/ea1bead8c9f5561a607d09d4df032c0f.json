{"remainingRequest":"E:\\project4\\20230518\\1\\102\\front\\front\\node_modules\\babel-loader\\lib\\index.js!E:\\project4\\20230518\\1\\102\\front\\front\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!E:\\project4\\20230518\\1\\102\\front\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\project4\\20230518\\1\\102\\front\\front\\src\\pages\\shop-cart\\list.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\project4\\20230518\\1\\102\\front\\front\\src\\pages\\shop-cart\\list.vue","mtime":1678016594000},{"path":"E:\\project4\\20230518\\1\\102\\front\\front\\babel.config.js","mtime":1678016589000},{"path":"E:\\project4\\20230518\\1\\102\\front\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\project4\\20230518\\1\\102\\front\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\project4\\20230518\\1\\102\\front\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\project4\\20230518\\1\\102\\front\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBjb25maWcgZnJvbSAnQC9jb25maWcvY29uZmlnJzsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBiYXNlVXJsOiBjb25maWcuYmFzZVVybCwKICAgICAgdGFibGVEYXRhOiBbXSwKICAgICAgc2VsUm93czogW10KICAgIH07CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRDYXJ0TGlzdCgpOwogIH0sCiAgbWV0aG9kczogewogICAgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlKGUpIHsKICAgICAgdGhpcy5zZWxSb3dzID0gZTsKICAgIH0sCiAgICBnZXRDYXJ0TGlzdCgpIHsKICAgICAgdGhpcy4kaHR0cC5nZXQoJ2NhcnQvbGlzdCcsIHsKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIHBhZ2U6IDEsCiAgICAgICAgICBsaW1pdDogMTAwMCwKICAgICAgICAgIHVzZXJpZDogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJpZCcpCiAgICAgICAgfQogICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT0gMCkgewogICAgICAgICAgdGhpcy50YWJsZURhdGEgPSByZXMuZGF0YS5kYXRhLmxpc3Q7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVDaGFuZ2UodmFsdWUsIGluZGV4LCByb3cpIHsKICAgICAgdGhpcy4kaHR0cC5nZXQoYCR7cm93LnRhYmxlbmFtZX0vZGV0YWlsLyR7cm93Lmdvb2RpZH1gKS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT0gMCAmJiB2YWx1ZSA+IHJlcy5kYXRhLmRhdGEub25lbGltaXR0aW1lcykgewogICAgICAgICAgdGhpcy50YWJsZURhdGFbaW5kZXhdLmJ1eW51bWJlciA9IC0tdmFsdWU7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKGDmr4/kurrljZXmrKHlj6rog73otK3kubAke3Jlcy5kYXRhLmRhdGEub25lbGltaXR0aW1lc33ku7ZgKTsKICAgICAgICB9CiAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT0gMCAmJiB2YWx1ZSA8PSByZXMuZGF0YS5kYXRhLm9uZWxpbWl0dGltZXMpIHsKICAgICAgICAgIHJvdy5idXludW1iZXIgPSB2YWx1ZTsKICAgICAgICAgIHRoaXMuJGh0dHAucG9zdCgnY2FydC91cGRhdGUnLCByb3cpLnRoZW4ocmVzID0+IHt9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGhhbmRsZURlbGV0ZShpbmRleCwgcm93KSB7CiAgICAgIHRoaXMuJGNvbmZpcm0oJ+aYr+WQpuehruiupOWIoOmZpD8nLCAn5o+Q56S6JywgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgbGV0IGRlbElkcyA9IG5ldyBBcnJheSgpOwogICAgICAgIGRlbElkcy5wdXNoKHJvdy5pZCk7CiAgICAgICAgdGhpcy4kaHR0cC5wb3N0KCdjYXJ0L2RlbGV0ZScsIGRlbElkcykudGhlbihyZXMgPT4gewogICAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT0gMCkgewogICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgICAgbWVzc2FnZTogJ+WIoOmZpOaIkOWKnyEnLAogICAgICAgICAgICAgIGR1cmF0aW9uOiAxNTAwLAogICAgICAgICAgICAgIG9uQ2xvc2U6ICgpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q2FydExpc3QoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBidXlDbGljaygpIHsKICAgICAgaWYgKHRoaXMuc2VsUm93cy5sZW5ndGggPT0gMCkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgdHlwZTogJ3dhcm5pbmcnLAogICAgICAgICAgbWVzc2FnZTogJ+ivt+mAieaLqeWVhuWTgScsCiAgICAgICAgICBkdXJhdGlvbjogMTUwMAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB2YXIgZ24gPSAiIjsKICAgICAgZm9yIChsZXQgeCBpbiB0aGlzLnNlbFJvd3MpIHsKICAgICAgICB2YXIgZyA9IHRoaXMuc2VsUm93c1t4XTsKICAgICAgICBjb25zb2xlLmxvZyhnLmdvb2RuYW1lKTsKICAgICAgICBsZXQgdGhhdCA9IHRoaXM7CiAgICAgICAgdGhpcy4kaHR0cC5nZXQoYCR7Zy50YWJsZW5hbWV9L2RldGFpbC8ke2cuZ29vZGlkfWApLnRoZW4ocmVzID0+IHsKICAgICAgICAgIGlmIChyZXMuZGF0YS5jb2RlID09IDAgJiYgZy5idXludW1iZXIgPiByZXMuZGF0YS5kYXRhLmFsbGxpbWl0dGltZXMpIHsKICAgICAgICAgICAgZ24gPSBnLmdvb2RuYW1lOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGlmIChnbiA9PSAiIikgewogICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ29yZGVyR29vZHMnLCBKU09OLnN0cmluZ2lmeSh0aGlzLnNlbFJvd3MpKTsKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvaW5kZXgvc2hvcC1vcmRlci9vcmRlckNvbmZpcm0nKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihnbiArIGAg5bqT5a2Y5LiN6LazYCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9LCAyMDApOwogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHRvdGFsUHJpY2UoKSB7CiAgICAgIGxldCB0b3RhbFByaWNlID0gMDsKICAgICAgZm9yIChsZXQgeCBpbiB0aGlzLnNlbFJvd3MpIHsKICAgICAgICB0b3RhbFByaWNlICs9IE51bWJlcih0aGlzLnNlbFJvd3NbeF0ucHJpY2UpICogTnVtYmVyKHRoaXMuc2VsUm93c1t4XS5idXludW1iZXIpOwogICAgICB9CiAgICAgIHJldHVybiB0b3RhbFByaWNlLnRvRml4ZWQoMik7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["config","data","baseUrl","tableData","selRows","created","getCartList","methods","handleSelectionChange","e","$http","get","params","page","limit","userid","localStorage","getItem","then","res","code","list","handleChange","value","index","row","tablename","goodid","onelimittimes","buynumber","$message","error","post","handleDelete","$confirm","confirmButtonText","cancelButtonText","type","delIds","Array","push","id","message","duration","onClose","buyClick","length","gn","x","g","console","log","goodname","that","alllimittimes","setTimeout","setItem","JSON","stringify","$router","computed","totalPrice","Number","price","toFixed"],"sources":["src/pages/shop-cart/list.vue"],"sourcesContent":["<template>\r\n<div :style='{\"width\":\"calc(100% - 40px)\",\"padding\":\"30px 20px 40px\",\"margin\":\"20px auto 0\",\"position\":\"relative\",\"background\":\"rgba(255,255,255,.3)\"}'>\r\n    <div class=\"section-title\" :style='{\"padding\":\"30px 0 30px\",\"margin\":\"20px auto 20px\",\"borderColor\":\"#9dcde9\",\"color\":\"#333\",\"textAlign\":\"center\",\"borderRadius\":\"0px\",\"background\":\"linear-gradient(320deg, rgba(204,204,204,.0) 0%, rgba(255,255,255,.9) 80%, rgba(204,204,204,.0) 100%)\",\"borderWidth\":\"6px\",\"width\":\"100%\",\"fontSize\":\"30px\",\"lineHeight\":\"30px\",\"borderStyle\":\"dotted\",\"fontWeight\":\"600\"}'>购物车</div>\r\n    <el-table\r\n      @selection-change=\"handleSelectionChange\"\r\n      :data=\"tableData\"\r\n      style=\"width: 100%\">\r\n      <el-table-column type=\"selection\" width=\"50\" align=\"center\" />\r\n      <el-table-column\r\n        label=\"商品名称\">\r\n        <template slot-scope=\"scope\">\r\n          <div class=\"shangpin\">\r\n            <el-image\r\n              style=\"width: 100px; height: 100px\"\r\n              :src=\"baseUrl + scope.row.picture\"\r\n              fit=\"fill\"></el-image>\r\n            <span style=\"margin-left: 10px\">{{ scope.row.goodname }}</span>\r\n          </div>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column\r\n        label=\"价格\">\r\n        <template slot-scope=\"scope\">\r\n          <span :style='{\"fontSize\":\"12px\"}'>￥</span>{{ scope.row.price }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column\r\n        label=\"数量\">\r\n        <template slot-scope=\"scope\">\r\n          <el-input-number :min=\"1\" v-model=\"scope.row.buynumber\" @change=\"(value) => handleChange(value, scope.$index, scope.row)\" size=\"small\"></el-input-number>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column\r\n        label=\"总价\">\r\n        <template slot-scope=\"scope\">\r\n          <span :style='{\"fontSize\":\"12px\"}'>￥</span>{{ (scope.row.price * scope.row.buynumber).toFixed(2) }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"操作\" width=\"150\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button\r\n            size=\"mini\"\r\n            type=\"danger\"\r\n            @click=\"handleDelete(scope.$index, scope.row)\">删除</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <div class=\"buy\" v-if=\"tableData.length > 0\">\r\n      <span style=\"color: red;margin-right: 10px;font-weight: 700;\">总价：<span :style='{\"fontSize\":\"12px\"}'>￥</span>{{totalPrice}}</span>\r\n      <el-button\r\n        type=\"warning\"\r\n        @click=\"buyClick\">点击购买</el-button>\r\n    </div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\n  import config from '@/config/config'\r\n  export default {\r\n    data() {\r\n      return {\r\n        baseUrl: config.baseUrl,\r\n        tableData: [],\r\n        selRows:[]\r\n      }\r\n    },\r\n    created() {\r\n      this.getCartList();\r\n    },\r\n    methods: {\r\n      handleSelectionChange(e){\r\n          this.selRows = e\r\n      },\r\n      getCartList() {\r\n        this.$http.get('cart/list', {params: {page: 1, limit: 1000, userid: localStorage.getItem('userid')}}).then(res => {\r\n          if (res.data.code == 0) {\r\n            this.tableData = res.data.data.list;\r\n          }\r\n        });\r\n      },\r\n      handleChange(value, index, row) {\r\n        this.$http.get(`${row.tablename}/detail/${row.goodid}`).then(res => {\r\n          if (res.data.code == 0 && value > res.data.data.onelimittimes) {\r\n            this.tableData[index].buynumber = --value;\r\n            this.$message.error(`每人单次只能购买${res.data.data.onelimittimes}件`);\r\n          }\r\n          if (res.data.code == 0 && value <= res.data.data.onelimittimes) {\r\n            row.buynumber = value;\r\n            this.$http.post('cart/update', row).then(res => {});\r\n          }\r\n        });\r\n      },\r\n      handleDelete(index, row) {\r\n        this.$confirm('是否确认删除?', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n          let delIds = new Array();\r\n          delIds.push(row.id);\r\n          this.$http.post('cart/delete', delIds).then(res => {\r\n            if (res.data.code == 0) {\r\n              this.$message({\r\n                type: 'success',\r\n                message: '删除成功!',\r\n                duration: 1500,\r\n                onClose: () => {\r\n                  this.getCartList();\r\n                }\r\n              });\r\n            }\r\n          });\r\n        });\r\n      },\r\n      buyClick() {\r\n        if(this.selRows.length==0) {\r\n            this.$message({\r\n                type: 'warning',\r\n                message: '请选择商品',\r\n                duration: 1500,\r\n            });\r\n            return\r\n        }\r\n        var gn = \"\";\r\n        for(let x in this.selRows){\r\n            var g = this.selRows[x];\r\n            console.log(g.goodname)\r\n            let that = this;\r\n            this.$http.get(`${g.tablename}/detail/${g.goodid}`).then(res => {\r\n              if (res.data.code == 0 && g.buynumber > res.data.data.alllimittimes) {\r\n                gn = g.goodname;\r\n              }\r\n            });\r\n        }\r\n        \r\n        setTimeout(() => {\r\n            if(gn==\"\") {\r\n                localStorage.setItem('orderGoods', JSON.stringify(this.selRows));\r\n                this.$router.push('/index/shop-order/orderConfirm');\r\n            } else {\r\n                this.$message.error(gn+` 库存不足`);\r\n                return;\r\n            }\r\n        }, 200)\r\n      }\r\n    },\r\n    computed: {\r\n      totalPrice() {\r\n            let totalPrice = 0;\r\n            for(let x in this.selRows){\r\n                  totalPrice += Number(this.selRows[x].price) * Number(this.selRows[x].buynumber)\r\n            }\r\n            return totalPrice.toFixed(2);\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style rel=\"stylesheet/scss\" lang=\"scss\" scoped>\r\n  .section {\r\n    width: 900px;\r\n    margin: 0 auto;\r\n  }\r\n\r\n  .shangpin {\r\n    display: flex;\r\n  }\r\n  .buy {\r\n    text-align: right;\r\n    padding-right: 82px;\r\n  }\r\n</style>\r\n"],"mappings":"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"}]}